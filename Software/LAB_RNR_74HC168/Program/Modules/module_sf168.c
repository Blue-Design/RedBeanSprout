/*====================================================================================================*/
/*====================================================================================================*/
#include "stm32f1_system.h"
#include "module_sf168.h"
/*====================================================================================================*/
/*====================================================================================================*/
#define SF168_DSA   PBO(12)
#define SF168_DSB   PBO(13)
#define SF168_MR    PBO(14)
#define SF168_CP    PBO(15)
/*====================================================================================================*/
/*====================================================================================================*
**函數 : SF168_Config
**功能 : 74HC168 Config
**輸入 : None
**輸出 : None
**使用 : SF168_Config();
**====================================================================================================*/
/*====================================================================================================*/
void SF168_Config( void )
{
  GPIO_InitTypeDef GPIO_InitStruct;

  RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);

  GPIO_InitStruct.GPIO_Pin = GPIO_Pin_12 | GPIO_Pin_13 | GPIO_Pin_14 | GPIO_Pin_15;
  GPIO_InitStruct.GPIO_Speed = GPIO_Speed_50MHz;
  GPIO_InitStruct.GPIO_Mode = GPIO_Mode_Out_PP;
  GPIO_Init(GPIOB, &GPIO_InitStruct);
}
/*====================================================================================================*/
/*====================================================================================================*
**函數 : SF168_Init
**功能 : 74HC168 Init
**輸入 : None
**輸出 : None
**使用 : SF168_Init();
**====================================================================================================*/
/*====================================================================================================*/
void SF168_Init( void )
{
  SF168_Reset();

  SF168_DSA = 0;
  SF168_DSB = 0;
  SF168_MR  = 1;
  SF168_CP  = 0;
}
/*====================================================================================================*/
/*====================================================================================================*
**函數 : SF168_Reset
**功能 : Reset 74HC168
**輸入 : None
**輸出 : None
**使用 : SF168_Reset();
**====================================================================================================*/
/*====================================================================================================*/
void SF168_Reset( void )
{
  SF168_MR = 0;
  Delay_1ms(1);
  SF168_MR = 1;
  Delay_1ms(1);
}
/*====================================================================================================*/
/*====================================================================================================*
**函數 : SF168_Shift
**功能 : Shift bit
**輸入 : SendData
**輸出 : None
**使用 : SF168_Shift(1);
**====================================================================================================*/
/*====================================================================================================*/
void SF168_Shift( u8 SendData )
{
  u8 tmp = 0;

  SF168_CP = 0;
  tmp = SendData & 0x01;
  SF168_DSA = tmp;
  SF168_DSB = tmp;
  SF168_CP = 1;
}
/*====================================================================================================*/
/*====================================================================================================*
**函數 : SF168_SendByte
**功能 : Shift 8 bits
**輸入 : SendData
**輸出 : None
**使用 : SF168_SendByte(SendData);
**====================================================================================================*/
/*====================================================================================================*/
void SF168_SendByte( u8 SendData )
{
  u8 i = 0;
  u8 tmp = 0;

  for(i=0; i<8; i++) {
    SF168_CP = 0;
    tmp = (SendData & (0x80>>i)) ? 1 : 0;
    SF168_DSA = tmp;
    SF168_DSB = tmp;
    SF168_CP = 1;
  }
}
/*====================================================================================================*/
/*====================================================================================================*/
